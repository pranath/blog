<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Feature Transformation with Amazon SageMaker Processing Job and Feature Store | livingdatalab</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Feature Transformation with Amazon SageMaker Processing Job and Feature Store" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="We will prepare to train a BERT-based natural language processing (NLP) model converting review text into machine-readable features used by BERT. With the required feature transformation we will configure an Amazon SageMaker processing job to perform the task." />
<meta property="og:description" content="We will prepare to train a BERT-based natural language processing (NLP) model converting review text into machine-readable features used by BERT. With the required feature transformation we will configure an Amazon SageMaker processing job to perform the task." />
<link rel="canonical" href="https://www.livingdatalab.com/aws/cloud-data-science/natural-language-processing/deep-learning/2023/02/08/feature-transformation-aws-sagemaker-processing-job-feature-store.html" />
<meta property="og:url" content="https://www.livingdatalab.com/aws/cloud-data-science/natural-language-processing/deep-learning/2023/02/08/feature-transformation-aws-sagemaker-processing-job-feature-store.html" />
<meta property="og:site_name" content="livingdatalab" />
<meta property="og:image" content="https://www.livingdatalab.com/images/aws.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2023-02-08T00:00:00-06:00" />
<script type="application/ld+json">
{"url":"https://www.livingdatalab.com/aws/cloud-data-science/natural-language-processing/deep-learning/2023/02/08/feature-transformation-aws-sagemaker-processing-job-feature-store.html","@type":"BlogPosting","headline":"Feature Transformation with Amazon SageMaker Processing Job and Feature Store","dateModified":"2023-02-08T00:00:00-06:00","datePublished":"2023-02-08T00:00:00-06:00","image":"https://www.livingdatalab.com/images/aws.png","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.livingdatalab.com/aws/cloud-data-science/natural-language-processing/deep-learning/2023/02/08/feature-transformation-aws-sagemaker-processing-job-feature-store.html"},"description":"We will prepare to train a BERT-based natural language processing (NLP) model converting review text into machine-readable features used by BERT. With the required feature transformation we will configure an Amazon SageMaker processing job to perform the task.","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://www.livingdatalab.com/feed.xml" title="livingdatalab" /><!-- the google_analytics_id gets auto inserted from the config file -->



<script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-91568149-1','auto');ga('require','displayfeatures');ga('send','pageview');</script>

<link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.css" integrity="sha512-h7nl+xz8wgDlNM4NqKEM4F1NkIRS17M9+uJwIGwuo8vGqIl4BhuCKdxjWEINm+xyrUjNCnK5dCrhM0sj+wTIXw==" crossorigin="anonymous" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.js" integrity="sha512-/CMIhXiDA3m2c9kzRyd97MTb3MC6OVnx4TElQ7fkkoRghwDf6gi41gaT1PwF270W6+J60uTmwgeRpNpJdRV6sg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/contrib/auto-render.min.js" integrity="sha512-Do7uJAaHZm5OLrIv/yN4w0iG1dbu01kzdMNnFfu/mAqgUk6Nniv2JYHcwH+cNwjqgLcqcuBBk+JRvprLVI8azg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha512-0doc9hKxR3PYwso42RD1p5ySZpzzuDiOwMrdCEh2WdJZCjcmFKc/wEnL+z8fBQrnHoiNWbo+3fiGkOYXBdQp4A==" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">livingdatalab</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About Livingdatalab</a><a class="page-link" href="/search/">Search</a><a class="page-link" href="/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Feature Transformation with Amazon SageMaker Processing Job and Feature Store</h1><p class="page-description">We will prepare to train a BERT-based natural language processing (NLP) model converting review text into machine-readable features used by BERT. With the required feature transformation we will configure an Amazon SageMaker processing job to perform the task.</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2023-02-08T00:00:00-06:00" itemprop="datePublished">
        Feb 8, 2023
      </time>
       â€¢ <span class="read-time" title="Estimated read time">
    
    
      33 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/categories/#aws">aws</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#cloud-data-science">cloud-data-science</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#natural-language-processing">natural-language-processing</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#deep-learning">deep-learning</a>
        
      
      </p>
    

    
      
        <div class="pb-5 d-flex flex-wrap flex-justify-end">
          
          
          
        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
<li class="toc-entry toc-h2"><a href="#Introduction">Introduction </a></li>
<li class="toc-entry toc-h2"><a href="#The-Bert-language-model">The Bert language model </a></li>
<li class="toc-entry toc-h2"><a href="#Feature-Engineering-at-Scale">Feature Engineering at Scale </a></li>
<li class="toc-entry toc-h2"><a href="#Import-Libraries-&-Initialise">Import Libraries &amp; Initialise </a></li>
<li class="toc-entry toc-h2"><a href="#Configure-the-SageMaker-Feature-Store">Configure the SageMaker Feature Store </a>
<ul>
<li class="toc-entry toc-h3"><a href="#Configure-dataset">Configure dataset </a></li>
<li class="toc-entry toc-h3"><a href="#Configure-the-SageMaker-feature-store">Configure the SageMaker feature store </a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#Transform-the-dataset">Transform the dataset </a></li>
<li class="toc-entry toc-h2"><a href="#Query-the-Feature-Store">Query the Feature Store </a>
<ul>
<li class="toc-entry toc-h3"><a href="#Export-training,-validation,-and-test-datasets-from-the-Feature-Store">Export training, validation, and test datasets from the Feature Store </a></li>
<li class="toc-entry toc-h3"><a href="#Export-TSV-from-Feature-Store">Export TSV from Feature Store </a></li>
<li class="toc-entry toc-h3"><a href="#Check-that-the-dataset-in-the-Feature-Store-is-balanced-by-sentiment">Check that the dataset in the Feature Store is balanced by sentiment </a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#Acknowledgements">Acknowledgements </a></li>
</ul><!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2023-02-08-feature-transformation-aws-sagemaker-processing-job-feature-store.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Introduction">
<a class="anchor" href="#Introduction" aria-hidden="true"><span class="octicon octicon-link"></span></a>Introduction<a class="anchor-link" href="#Introduction"> </a>
</h2>
<p>In <a href="https://livingdatalab.com/categories/#aws">earlier articles we introduced AWS cloud services for data science</a>, and showed how it can help with different stages of the data science &amp; machine learning workflow.</p>
<p><img src="https://github.com/pranath/blog/raw/master/images/aws_ds_workflow.png" alt="" title="The AWS Data Science Workflow"></p>
<p>In this article we will look at the <strong>Prepare &amp; Transform</strong> stage using AWS including:</p>
<ul>
<li>Feature engineering</li>
<li>Feature store</li>
</ul>
<p>Using the raw <a href="https://www.kaggle.com/nicapotato/womens-ecommerce-clothing-reviews">Women's Clothing Reviews</a> dataset - we will prepare it to train a BERT-based natural language processing (NLP) model. The model will be used to classify customer reviews into positive (1), neutral (0) and negative (-1) sentiment.</p>
<p>We will convert the original review text into machine-readable features used by BERT. To perform the required feature transformation we will configure an Amazon SageMaker processing job, which will be running a custom Python script.</p>
<h2 id="The-Bert-language-model">
<a class="anchor" href="#The-Bert-language-model" aria-hidden="true"><span class="octicon octicon-link"></span></a>The Bert language model<a class="anchor-link" href="#The-Bert-language-model"> </a>
</h2>
<p>BERT stands for 'Bidirectional Encoder Representations from Transformers'. So Bert language models are based on the transformer type models first created in 2017.</p>
<p><img src="https://github.com/pranath/blog/raw/master/images/aws_bert_history.png" alt="" title="The History of Language Models"></p>
<p>In a <a href="https://livingdatalab.com/aws/cloud-data-science/natural-language-processing/deep-learning/2023/02/06/creating-text-classifier-using-aws-sagemaker-blazingtext.html">previous article we used a Blazing Text Language Model</a> to create a text classifier. Blazing Text language models are in turn based on Word2Vec type language models. But how do word2vec/Blazing text language models work? essentially these models convert individual words into a series of numbers or a <em>vector</em>.</p>
<p><img src="https://github.com/pranath/blog/raw/master/images/aws_blazingtext_embed.png" alt="" title="Blazing Text Embeddings"></p>
<p>I used word2vec in one of my first data science/deep learning projects back in 2019 <a href="https://docs.google.com/presentation/d/164oDiuEZFR35X9QEJN1R-rOb4sp5r32DxR4Xm6z-Qgs/edit#slide=id.p">classifying disaster text messages</a>.</p>
<p>This means with word2vec similar meaning words will have similar numbers and vector positions, this is what this language model learns. The downside of this approach though is it allows only for one sense of what a word might mean - but we know in practice the meaning of a word can be effected by the context.</p>
<p>For example, if we were trying to decide if these two phrases were positive or negative:</p>
<ul>
<li>I love the dress</li>
<li>I love the dress, but not the price</li>
</ul>
<p>A word2vec model might end up giving quite positive sentiment to both of these phrases when summing up the meaning of these words individually, yet we can see that the second phrase might have more neutral if not negative sentiment, because here 'love', usually positive, has been modified by the context of the words its within.</p>
<p>This is one key thing that transformer models such as BERT or GPT can do, <strong>they can take into account the context of a word, and indeed process an entire phrase in one go to give a vector for that group of words, rather than for one word at a time.</strong></p>
<p><img src="https://github.com/pranath/blog/raw/master/images/aws_bert_embed.png" alt="" title="The Bert Embeddings"></p>
<p>In particular transformers use <em>attention</em> to capture the relationship and meaning between words used together. You can find out more about the differences between word2vec and transformer models <a href="https://towardsdatascience.com/word2vec-to-transformers-caf5a3daa08a">here</a>.</p>
<h2 id="Feature-Engineering-at-Scale">
<a class="anchor" href="#Feature-Engineering-at-Scale" aria-hidden="true"><span class="octicon octicon-link"></span></a>Feature Engineering at Scale<a class="anchor-link" href="#Feature-Engineering-at-Scale"> </a>
</h2>
<p>Amazon SageMaker processing allows you to perform data related tasks such as, preprocessing, postprocessing, and model evaluation at scale. SageMaker processing provides this capability by using a distributed cluster. By specifying some parameters, you can control how many notes and the type of the notes that make up the distributed cluster.</p>
<p><img src="https://github.com/pranath/blog/raw/master/images/aws_processing.png" alt="" title="Amazon SageMaker Processing"></p>
<p>Sagemaker Feature Store is a fully managed service that provides purpose-built feature store. SageMaker Feature Store provides you with a centralized repository to securely save and serve features from.</p>
<p>Next, SageMaker Feature Store provides you with the capabilities to reuse the features, not just across a single machine learning project, but across multiple projects. A typical challenge that data scientist sees is training an inference skew that could result from discrepancies in the data used for training and the data used for inferencing. Sagemaker Feature Store helps reduce the skew by reusing the features across training and inference traces and by keeping the features consistent.</p>
<p>Finally, SageMaker Feature Store provides the capabilities to create it for the features both in real time and batch. The ability to creating for features in real time suppose use cases such as near real time ML predictions. Similarly, the ability to look up features in batch mode can be used to support use cases, such as model training.</p>
<p><img src="https://github.com/pranath/blog/raw/master/images/aws_feature_store.png" alt="" title="AWS Feature Store"></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Import-Libraries-&amp;-Initialise">
<a class="anchor" href="#Import-Libraries-&amp;-Initialise" aria-hidden="true"><span class="octicon octicon-link"></span></a>Import Libraries &amp; Initialise<a class="anchor-link" href="#Import-Libraries-&amp;-Initialise"> </a>
</h2>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">boto3</span>
<span class="kn">import</span> <span class="nn">sagemaker</span>
<span class="kn">import</span> <span class="nn">botocore</span>

<span class="n">config</span> <span class="o">=</span> <span class="n">botocore</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">Config</span><span class="p">(</span><span class="n">user_agent_extra</span><span class="o">=</span><span class="s1">'dlai-pds/c2/w1'</span><span class="p">)</span>

<span class="c1"># low-level service client of the boto3 session</span>
<span class="n">sm</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="n">service_name</span><span class="o">=</span><span class="s1">'sagemaker'</span><span class="p">,</span> 
                  <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">)</span>

<span class="n">featurestore_runtime</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="n">service_name</span><span class="o">=</span><span class="s1">'sagemaker-featurestore-runtime'</span><span class="p">,</span> 
                                    <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">)</span>

<span class="n">sess</span> <span class="o">=</span> <span class="n">sagemaker</span><span class="o">.</span><span class="n">Session</span><span class="p">(</span><span class="n">sagemaker_client</span><span class="o">=</span><span class="n">sm</span><span class="p">,</span>
                         <span class="n">sagemaker_featurestore_runtime_client</span><span class="o">=</span><span class="n">featurestore_runtime</span><span class="p">)</span>

<span class="n">bucket</span> <span class="o">=</span> <span class="n">sess</span><span class="o">.</span><span class="n">default_bucket</span><span class="p">()</span>
<span class="n">role</span> <span class="o">=</span> <span class="n">sagemaker</span><span class="o">.</span><span class="n">get_execution_role</span><span class="p">()</span>
<span class="n">region</span> <span class="o">=</span> <span class="n">sess</span><span class="o">.</span><span class="n">boto_region_name</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Configure-the-SageMaker-Feature-Store">
<a class="anchor" href="#Configure-the-SageMaker-Feature-Store" aria-hidden="true"><span class="octicon octicon-link"></span></a>Configure the SageMaker Feature Store<a class="anchor-link" href="#Configure-the-SageMaker-Feature-Store"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Configure-dataset">
<a class="anchor" href="#Configure-dataset" aria-hidden="true"><span class="octicon octicon-link"></span></a>Configure dataset<a class="anchor-link" href="#Configure-dataset"> </a>
</h3>
<p>The raw dataset is in the public S3 bucket. Let's start by specifying the S3 location of it:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">raw_input_data_s3_uri</span> <span class="o">=</span> <span class="s1">'s3://dlai-practical-data-science/data/raw/'</span>
<span class="nb">print</span><span class="p">(</span><span class="n">raw_input_data_s3_uri</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>s3://dlai-practical-data-science/data/raw/
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>List the files in the S3 bucket (in this case it will be just one file):</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>aws s3 ls <span class="nv">$raw_input_data_s3_uri</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>2021-04-30 02:21:06    8457214 womens_clothing_ecommerce_reviews.csv
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Configure-the-SageMaker-feature-store">
<a class="anchor" href="#Configure-the-SageMaker-feature-store" aria-hidden="true"><span class="octicon octicon-link"></span></a>Configure the SageMaker feature store<a class="anchor-link" href="#Configure-the-SageMaker-feature-store"> </a>
</h3>
<p>As the result of the transformation, in addition to generating files in S3 bucket, we will also save the transformed data in the <strong>Amazon SageMaker Feature Store</strong> to be used by others in our organization, for example.</p>
<p>To configure a Feature Store we need to setup a <strong>Feature Group</strong>. This is the main resource containing all of the metadata related to the data stored in the Feature Store.</p>
<p>A Feature Group should contain a list of <strong>Feature Definitions</strong>. A Feature Definition consists of a name and the data type. The Feature Group also contains an online store configuration and an offline store configuration controlling where the data is stored. Enabling the online store allows quick access to the latest value for a record via the <a href="https://docs.aws.amazon.com/sagemaker/latest/APIReference/API_feature_store_GetRecord.html">GetRecord API</a>. The offline store allows storage of the data in your S3 bucket. We will be using the offline store here.</p>
<p>Let's setup the Feature Group name and the Feature Store offline prefix in S3 bucket.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">time</span>
<span class="n">timestamp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">())</span>

<span class="n">feature_group_name</span> <span class="o">=</span> <span class="s1">'reviews-feature-group-'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)</span>
<span class="n">feature_store_offline_prefix</span> <span class="o">=</span> <span class="s1">'reviews-feature-store-'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">'Feature group name: </span><span class="si">{}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">feature_group_name</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'Feature store offline prefix in S3: </span><span class="si">{}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">feature_store_offline_prefix</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Feature group name: reviews-feature-group-1675799708
Feature store offline prefix in S3: reviews-feature-store-1675799708
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Taking two features from the original raw dataset (<code>Review Text</code> and <code>Rating</code>), we will transform it preparing to be used for the model training and then to be saved in the Feature Store. Here we will define the related features to be stored as a list of <code>FeatureDefinition</code>.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sagemaker.feature_store.feature_definition</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">FeatureDefinition</span><span class="p">,</span>
    <span class="n">FeatureTypeEnum</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">feature_definitions</span><span class="o">=</span> <span class="p">[</span>
    <span class="c1"># unique ID of the review</span>
    <span class="n">FeatureDefinition</span><span class="p">(</span><span class="n">feature_name</span><span class="o">=</span><span class="s1">'review_id'</span><span class="p">,</span> <span class="n">feature_type</span><span class="o">=</span><span class="n">FeatureTypeEnum</span><span class="o">.</span><span class="n">STRING</span><span class="p">),</span> 
    <span class="c1"># ingestion timestamp</span>
    <span class="n">FeatureDefinition</span><span class="p">(</span><span class="n">feature_name</span><span class="o">=</span><span class="s1">'date'</span><span class="p">,</span> <span class="n">feature_type</span><span class="o">=</span><span class="n">FeatureTypeEnum</span><span class="o">.</span><span class="n">STRING</span><span class="p">),</span>
    <span class="c1"># sentiment: -1 (negative), 0 (neutral) or 1 (positive). It will be found the Rating values (1, 2, 3, 4, 5)</span>
    <span class="n">FeatureDefinition</span><span class="p">(</span><span class="n">feature_name</span><span class="o">=</span><span class="s1">'sentiment'</span><span class="p">,</span> <span class="n">feature_type</span><span class="o">=</span><span class="n">FeatureTypeEnum</span><span class="o">.</span><span class="n">STRING</span><span class="p">),</span> 
    <span class="c1"># label ID of the target class (sentiment)</span>
    <span class="n">FeatureDefinition</span><span class="p">(</span><span class="n">feature_name</span><span class="o">=</span><span class="s1">'label_id'</span><span class="p">,</span> <span class="n">feature_type</span><span class="o">=</span><span class="n">FeatureTypeEnum</span><span class="o">.</span><span class="n">STRING</span><span class="p">),</span>
    <span class="c1"># reviews encoded with the BERT tokenizer</span>
    <span class="n">FeatureDefinition</span><span class="p">(</span><span class="n">feature_name</span><span class="o">=</span><span class="s1">'input_ids'</span><span class="p">,</span> <span class="n">feature_type</span><span class="o">=</span><span class="n">FeatureTypeEnum</span><span class="o">.</span><span class="n">STRING</span><span class="p">),</span>
    <span class="c1"># original Review Text</span>
    <span class="n">FeatureDefinition</span><span class="p">(</span><span class="n">feature_name</span><span class="o">=</span><span class="s1">'review_body'</span><span class="p">,</span> <span class="n">feature_type</span><span class="o">=</span><span class="n">FeatureTypeEnum</span><span class="o">.</span><span class="n">STRING</span><span class="p">),</span>
    <span class="c1"># train/validation/test label</span>
    <span class="n">FeatureDefinition</span><span class="p">(</span><span class="n">feature_name</span><span class="o">=</span><span class="s1">'split_type'</span><span class="p">,</span> <span class="n">feature_type</span><span class="o">=</span><span class="n">FeatureTypeEnum</span><span class="o">.</span><span class="n">STRING</span><span class="p">)</span>
<span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's create the feature group using the feature definitions defined above.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sagemaker.feature_store.feature_group</span> <span class="kn">import</span> <span class="n">FeatureGroup</span>

<span class="n">feature_group</span> <span class="o">=</span> <span class="n">FeatureGroup</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="n">feature_group_name</span><span class="p">,</span> 
    <span class="n">feature_definitions</span><span class="o">=</span><span class="n">feature_definitions</span><span class="p">,</span> 
    <span class="n">sagemaker_session</span><span class="o">=</span><span class="n">sess</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">feature_group</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>FeatureGroup(name='reviews-feature-group-1675799708', sagemaker_session=&lt;sagemaker.session.Session object at 0x7f9cb912c350&gt;, feature_definitions=[FeatureDefinition(feature_name='review_id', feature_type=&lt;FeatureTypeEnum.STRING: 'String'&gt;), FeatureDefinition(feature_name='date', feature_type=&lt;FeatureTypeEnum.STRING: 'String'&gt;), FeatureDefinition(feature_name='sentiment', feature_type=&lt;FeatureTypeEnum.STRING: 'String'&gt;), FeatureDefinition(feature_name='label_id', feature_type=&lt;FeatureTypeEnum.STRING: 'String'&gt;), FeatureDefinition(feature_name='input_ids', feature_type=&lt;FeatureTypeEnum.STRING: 'String'&gt;), FeatureDefinition(feature_name='review_body', feature_type=&lt;FeatureTypeEnum.STRING: 'String'&gt;), FeatureDefinition(feature_name='split_type', feature_type=&lt;FeatureTypeEnum.STRING: 'String'&gt;)])
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We will use the defined Feature Group later in this project, the actual creation of the Feature Group will take place in the processing job. Now let's move into the setup of the processing job to transform the dataset.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Transform-the-dataset">
<a class="anchor" href="#Transform-the-dataset" aria-hidden="true"><span class="octicon octicon-link"></span></a>Transform the dataset<a class="anchor-link" href="#Transform-the-dataset"> </a>
</h2>
<p>We will configure a SageMaker processing job to run a custom Python script to balance and transform the raw data into a format used by BERT model.</p>
<p>Let's set the transformation parameters including the instance type, instance count, and train/validation/test split percentages. We will use a relatively small instance type for this project. Please refer to <a href="https://aws.amazon.com/sagemaker/pricing/">this</a> link for additional instance types that may work for your use case.</p>
<p>We can also choose whether you want to balance the dataset or not. In this case, we will balance the dataset to avoid class imbalance in the target variable, <code>sentiment</code>.</p>
<p>Another important parameter of the model is the <code>max_seq_length</code>, which specifies the maximum length of the classified reviews for the RoBERTa model. If the sentence is shorter than the maximum length parameter, it will be padded. In another case, when the sentence is longer, it will be truncated from the right side.</p>
<p>Since a smaller <code>max_seq_length</code> leads to faster training and lower resource utilization, you want to find the smallest power-of-2 that captures <code>100%</code> of our reviews.  For this dataset, the <code>100th</code> percentile is <code>115</code>.  However, it's best to stick with powers-of-2 when using BERT. So let's choose <code>128</code> as this is the smallest power-of-2 greater than <code>115</code>. We will see below how the shorter sentences will be padded to a maximum length.</p>

<pre><code>mean        52.512374
std         31.387048
min          1.000000
10%         10.000000
20%         22.000000
30%         32.000000
40%         41.000000
50%         51.000000
60%         61.000000
70%         73.000000
80%         88.000000
90%         97.000000
100%       115.000000
max        115.000000</code></pre>
<p><img src="https://github.com/pranath/blog/raw/master/images/distribution_num_words_per_review.png" alt="" title="Histogram of text sequence lengths"></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">processing_instance_type</span><span class="o">=</span><span class="s1">'ml.c5.xlarge'</span>
<span class="n">processing_instance_count</span><span class="o">=</span><span class="mi">1</span>
<span class="n">train_split_percentage</span><span class="o">=</span><span class="mf">0.90</span>
<span class="n">validation_split_percentage</span><span class="o">=</span><span class="mf">0.05</span>
<span class="n">test_split_percentage</span><span class="o">=</span><span class="mf">0.05</span>
<span class="n">balance_dataset</span><span class="o">=</span><span class="kc">True</span>
<span class="n">max_seq_length</span><span class="o">=</span><span class="mi">128</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To balance and transform our data, we will use a scikit-learn-based processing job. This is essentially a generic Python processing job with scikit-learn pre-installed. We can specify the version of scikit-learn we wish to use. Also we will pass the SageMaker execution role, processing instance type and instance count.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sagemaker.sklearn.processing</span> <span class="kn">import</span> <span class="n">SKLearnProcessor</span>

<span class="n">processor</span> <span class="o">=</span> <span class="n">SKLearnProcessor</span><span class="p">(</span>
    <span class="n">framework_version</span><span class="o">=</span><span class="s1">'0.23-1'</span><span class="p">,</span>
    <span class="n">role</span><span class="o">=</span><span class="n">role</span><span class="p">,</span>
    <span class="n">instance_type</span><span class="o">=</span><span class="n">processing_instance_type</span><span class="p">,</span>
    <span class="n">instance_count</span><span class="o">=</span><span class="n">processing_instance_count</span><span class="p">,</span>
    <span class="n">env</span><span class="o">=</span><span class="p">{</span><span class="s1">'AWS_DEFAULT_REGION'</span><span class="p">:</span> <span class="n">region</span><span class="p">},</span>                             
    <span class="n">max_runtime_in_seconds</span><span class="o">=</span><span class="mi">7200</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The processing job will be running the Python code from the file <code>src/prepare_data.py</code>.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span><span class="o">,</span> <span class="nn">importlib</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">'src/'</span><span class="p">)</span>

<span class="c1"># import the `prepare_data.py` module</span>
<span class="kn">import</span> <span class="nn">prepare_data</span>

<span class="c1"># reload the module if it has been previously loaded </span>
<span class="k">if</span> <span class="s1">'prepare_data'</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">:</span>
    <span class="n">importlib</span><span class="o">.</span><span class="n">reload</span><span class="p">(</span><span class="n">prepare_data</span><span class="p">)</span>

<span class="n">input_ids</span> <span class="o">=</span> <span class="n">prepare_data</span><span class="o">.</span><span class="n">convert_to_bert_input_ids</span><span class="p">(</span><span class="s2">"this product is great!"</span><span class="p">,</span> <span class="n">max_seq_length</span><span class="p">)</span>
    
<span class="n">updated_correctly</span> <span class="o">=</span> <span class="kc">False</span>

<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">input_ids</span><span class="p">)</span> <span class="o">!=</span> <span class="n">max_seq_length</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">'Please check that the function </span><span class="se">\'</span><span class="s1">convert_to_bert_input_ids</span><span class="se">\'</span><span class="s1"> in the file src/prepare_data.py is complete.'</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'##################'</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'Updated correctly!'</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'##################'</span><span class="p">)</span>

    <span class="n">updated_correctly</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>##################
Updated correctly!
##################
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">input_ids</span> <span class="o">=</span> <span class="n">prepare_data</span><span class="o">.</span><span class="n">convert_to_bert_input_ids</span><span class="p">(</span><span class="s2">"this product is great!"</span><span class="p">,</span> <span class="n">max_seq_length</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">input_ids</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'Length of the sequence: </span><span class="si">{}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">input_ids</span><span class="p">)))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[0, 9226, 1152, 16, 372, 328, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
Length of the sequence: 128
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now we launch the processing job with the custom script passing defined above parameters.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sagemaker.processing</span> <span class="kn">import</span> <span class="n">ProcessingInput</span><span class="p">,</span> <span class="n">ProcessingOutput</span>

<span class="k">if</span> <span class="p">(</span><span class="n">updated_correctly</span><span class="p">):</span>

    <span class="n">processor</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">code</span><span class="o">=</span><span class="s1">'src/prepare_data.py'</span><span class="p">,</span>
              <span class="n">inputs</span><span class="o">=</span><span class="p">[</span>
                    <span class="n">ProcessingInput</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="n">raw_input_data_s3_uri</span><span class="p">,</span>
                                    <span class="n">destination</span><span class="o">=</span><span class="s1">'/opt/ml/processing/input/data/'</span><span class="p">,</span>
                                    <span class="n">s3_data_distribution_type</span><span class="o">=</span><span class="s1">'ShardedByS3Key'</span><span class="p">)</span>
              <span class="p">],</span>
              <span class="n">outputs</span><span class="o">=</span><span class="p">[</span>
                    <span class="n">ProcessingOutput</span><span class="p">(</span><span class="n">output_name</span><span class="o">=</span><span class="s1">'sentiment-train'</span><span class="p">,</span>
                                     <span class="n">source</span><span class="o">=</span><span class="s1">'/opt/ml/processing/output/sentiment/train'</span><span class="p">,</span>
                                     <span class="n">s3_upload_mode</span><span class="o">=</span><span class="s1">'EndOfJob'</span><span class="p">),</span>
                    <span class="n">ProcessingOutput</span><span class="p">(</span><span class="n">output_name</span><span class="o">=</span><span class="s1">'sentiment-validation'</span><span class="p">,</span>
                                     <span class="n">source</span><span class="o">=</span><span class="s1">'/opt/ml/processing/output/sentiment/validation'</span><span class="p">,</span>
                                     <span class="n">s3_upload_mode</span><span class="o">=</span><span class="s1">'EndOfJob'</span><span class="p">),</span>
                    <span class="n">ProcessingOutput</span><span class="p">(</span><span class="n">output_name</span><span class="o">=</span><span class="s1">'sentiment-test'</span><span class="p">,</span>
                                     <span class="n">source</span><span class="o">=</span><span class="s1">'/opt/ml/processing/output/sentiment/test'</span><span class="p">,</span>
                                     <span class="n">s3_upload_mode</span><span class="o">=</span><span class="s1">'EndOfJob'</span><span class="p">)</span>
              <span class="p">],</span>
              <span class="n">arguments</span><span class="o">=</span><span class="p">[</span><span class="s1">'--train-split-percentage'</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">train_split_percentage</span><span class="p">),</span>
                         <span class="s1">'--validation-split-percentage'</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">validation_split_percentage</span><span class="p">),</span>
                         <span class="s1">'--test-split-percentage'</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">test_split_percentage</span><span class="p">),</span>
                         <span class="s1">'--balance-dataset'</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">balance_dataset</span><span class="p">),</span>
                         <span class="s1">'--max-seq-length'</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">max_seq_length</span><span class="p">),</span>                         
                         <span class="s1">'--feature-store-offline-prefix'</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">feature_store_offline_prefix</span><span class="p">),</span>
                         <span class="s1">'--feature-group-name'</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">feature_group_name</span><span class="p">)</span>                         
              <span class="p">],</span>
              <span class="n">logs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
              <span class="n">wait</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
Job Name:  sagemaker-scikit-learn-2023-02-07-19-57-59-405
Inputs:  [{'InputName': 'input-1', 'AppManaged': False, 'S3Input': {'S3Uri': 's3://dlai-practical-data-science/data/raw/', 'LocalPath': '/opt/ml/processing/input/data/', 'S3DataType': 'S3Prefix', 'S3InputMode': 'File', 'S3DataDistributionType': 'ShardedByS3Key', 'S3CompressionType': 'None'}}, {'InputName': 'code', 'AppManaged': False, 'S3Input': {'S3Uri': 's3://sagemaker-us-east-1-951182689916/sagemaker-scikit-learn-2023-02-07-19-57-59-405/input/code/prepare_data.py', 'LocalPath': '/opt/ml/processing/input/code', 'S3DataType': 'S3Prefix', 'S3InputMode': 'File', 'S3DataDistributionType': 'FullyReplicated', 'S3CompressionType': 'None'}}]
Outputs:  [{'OutputName': 'sentiment-train', 'AppManaged': False, 'S3Output': {'S3Uri': 's3://sagemaker-us-east-1-951182689916/sagemaker-scikit-learn-2023-02-07-19-57-59-405/output/sentiment-train', 'LocalPath': '/opt/ml/processing/output/sentiment/train', 'S3UploadMode': 'EndOfJob'}}, {'OutputName': 'sentiment-validation', 'AppManaged': False, 'S3Output': {'S3Uri': 's3://sagemaker-us-east-1-951182689916/sagemaker-scikit-learn-2023-02-07-19-57-59-405/output/sentiment-validation', 'LocalPath': '/opt/ml/processing/output/sentiment/validation', 'S3UploadMode': 'EndOfJob'}}, {'OutputName': 'sentiment-test', 'AppManaged': False, 'S3Output': {'S3Uri': 's3://sagemaker-us-east-1-951182689916/sagemaker-scikit-learn-2023-02-07-19-57-59-405/output/sentiment-test', 'LocalPath': '/opt/ml/processing/output/sentiment/test', 'S3UploadMode': 'EndOfJob'}}]
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>You can see the information about the processing jobs using the <code>describe</code> function. The result is in dictionary format. Let's pull the processing job name:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">scikit_processing_job_name</span> <span class="o">=</span> <span class="n">processor</span><span class="o">.</span><span class="n">jobs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()[</span><span class="s1">'ProcessingJobName'</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">'Processing job name: </span><span class="si">{}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">scikit_processing_job_name</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Processing job name: sagemaker-scikit-learn-2023-02-07-19-57-59-405
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's pull the processing job status from the processing job description.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">processor</span><span class="o">.</span><span class="n">jobs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>dict_keys(['ProcessingInputs', 'ProcessingOutputConfig', 'ProcessingJobName', 'ProcessingResources', 'StoppingCondition', 'AppSpecification', 'Environment', 'RoleArn', 'ProcessingJobArn', 'ProcessingJobStatus', 'LastModifiedTime', 'CreationTime', 'ResponseMetadata'])
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">scikit_processing_job_status</span> <span class="o">=</span> <span class="n">processor</span><span class="o">.</span><span class="n">jobs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()[</span><span class="s1">'ProcessingJobStatus'</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'Processing job status: </span><span class="si">{}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">scikit_processing_job_status</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Processing job status: InProgress
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>

<span class="n">running_processor</span> <span class="o">=</span> <span class="n">sagemaker</span><span class="o">.</span><span class="n">processing</span><span class="o">.</span><span class="n">ProcessingJob</span><span class="o">.</span><span class="n">from_processing_name</span><span class="p">(</span>
    <span class="n">processing_job_name</span><span class="o">=</span><span class="n">scikit_processing_job_name</span><span class="p">,</span>
    <span class="n">sagemaker_session</span><span class="o">=</span><span class="n">sess</span>
<span class="p">)</span>

<span class="n">running_processor</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="n">logs</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>....................................................................................................................................!CPU times: user 647 ms, sys: 44.3 ms, total: 691 ms
Wall time: 11min 13s
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's inspect the transformed and balanced data in the S3 bucket.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">processing_job_description</span> <span class="o">=</span> <span class="n">running_processor</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>

<span class="n">output_config</span> <span class="o">=</span> <span class="n">processing_job_description</span><span class="p">[</span><span class="s1">'ProcessingOutputConfig'</span><span class="p">]</span>
<span class="k">for</span> <span class="n">output</span> <span class="ow">in</span> <span class="n">output_config</span><span class="p">[</span><span class="s1">'Outputs'</span><span class="p">]:</span>
    <span class="k">if</span> <span class="n">output</span><span class="p">[</span><span class="s1">'OutputName'</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'sentiment-train'</span><span class="p">:</span>
        <span class="n">processed_train_data_s3_uri</span> <span class="o">=</span> <span class="n">output</span><span class="p">[</span><span class="s1">'S3Output'</span><span class="p">][</span><span class="s1">'S3Uri'</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">output</span><span class="p">[</span><span class="s1">'OutputName'</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'sentiment-validation'</span><span class="p">:</span>
        <span class="n">processed_validation_data_s3_uri</span> <span class="o">=</span> <span class="n">output</span><span class="p">[</span><span class="s1">'S3Output'</span><span class="p">][</span><span class="s1">'S3Uri'</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">output</span><span class="p">[</span><span class="s1">'OutputName'</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'sentiment-test'</span><span class="p">:</span>
        <span class="n">processed_test_data_s3_uri</span> <span class="o">=</span> <span class="n">output</span><span class="p">[</span><span class="s1">'S3Output'</span><span class="p">][</span><span class="s1">'S3Uri'</span><span class="p">]</span>
        
<span class="nb">print</span><span class="p">(</span><span class="n">processed_train_data_s3_uri</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">processed_validation_data_s3_uri</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">processed_test_data_s3_uri</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>s3://sagemaker-us-east-1-951182689916/sagemaker-scikit-learn-2023-02-07-19-57-59-405/output/sentiment-train
s3://sagemaker-us-east-1-951182689916/sagemaker-scikit-learn-2023-02-07-19-57-59-405/output/sentiment-validation
s3://sagemaker-us-east-1-951182689916/sagemaker-scikit-learn-2023-02-07-19-57-59-405/output/sentiment-test
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>aws s3 ls <span class="nv">$processed_train_data_s3_uri</span>/
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>2023-02-07 20:10:54    4896333 part-algo-1-womens_clothing_ecommerce_reviews.tsv
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>aws s3 ls <span class="nv">$processed_validation_data_s3_uri</span>/
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>2023-02-07 20:10:54     269735 part-algo-1-womens_clothing_ecommerce_reviews.tsv
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>aws s3 ls <span class="nv">$processed_test_data_s3_uri</span>/
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>2023-02-07 20:10:55     269933 part-algo-1-womens_clothing_ecommerce_reviews.tsv
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now we copy the data into the folder <code>balanced</code>.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>aws s3 cp <span class="nv">$processed_train_data_s3_uri</span>/part-algo-1-womens_clothing_ecommerce_reviews.tsv ./balanced/sentiment-train/
<span class="o">!</span>aws s3 cp <span class="nv">$processed_validation_data_s3_uri</span>/part-algo-1-womens_clothing_ecommerce_reviews.tsv ./balanced/sentiment-validation/
<span class="o">!</span>aws s3 cp <span class="nv">$processed_test_data_s3_uri</span>/part-algo-1-womens_clothing_ecommerce_reviews.tsv ./balanced/sentiment-test/
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>download: s3://sagemaker-us-east-1-951182689916/sagemaker-scikit-learn-2023-02-07-19-57-59-405/output/sentiment-train/part-algo-1-womens_clothing_ecommerce_reviews.tsv to balanced/sentiment-train/part-algo-1-womens_clothing_ecommerce_reviews.tsv
download: s3://sagemaker-us-east-1-951182689916/sagemaker-scikit-learn-2023-02-07-19-57-59-405/output/sentiment-validation/part-algo-1-womens_clothing_ecommerce_reviews.tsv to balanced/sentiment-validation/part-algo-1-womens_clothing_ecommerce_reviews.tsv
download: s3://sagemaker-us-east-1-951182689916/sagemaker-scikit-learn-2023-02-07-19-57-59-405/output/sentiment-test/part-algo-1-womens_clothing_ecommerce_reviews.tsv to balanced/sentiment-test/part-algo-1-womens_clothing_ecommerce_reviews.tsv
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's review the training, validation and test data outputs:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>head -n <span class="m">5</span> ./balanced/sentiment-train/part-algo-1-womens_clothing_ecommerce_reviews.tsv
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>review_id	sentiment	label_id	input_ids	review_body	date
15231	-1	0	[0, 100, 657, 13855, 27734, 111, 4682, 13, 42, 65, 4, 5, 10199, 16, 38596, 4, 24, 18, 227, 4136, 8, 5, 1468, 14, 51, 146, 9287, 66, 9, 4, 5, 5780, 16, 15652, 8, 5, 14893, 62, 5, 760, 32, 2422, 11962, 4, 5, 3318, 631, 14, 18, 95, 7209, 89, 116, 1437, 24, 18, 10, 3318, 631, 14, 95, 23835, 89, 4, 24, 630, 75, 1437, 356, 205, 7209, 1437, 8, 24, 630, 75, 356, 205, 3016, 4, 1437, 42, 13855, 6439, 56, 98, 203, 801, 4, 939, 437, 2299, 5779, 4, 1437, 13, 39328, 5135, 1437, 939, 524, 195, 108, 245, 113, 1437, 16157, 1437, 2631, 438, 8, 10, 650, 21, 1969, 4, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]	"I love jumpsuits - except for this one. the fabric is blah. it's between plastic and the material that they make flags out of. the print is adorable and the buttons up the front are super cute. the tie thing that's just hanging there?  it's a tie thing that just hangs there. it doesn't  look good hanging  and it doesn't look good tied.  this jumpsuit had so much potential. i'm definitely disappointed.  for sizing reference  i am 5'5""  135  34c and a small was perfect."	2023-02-07T20:04:40Z
8389	-1	0	[0, 100, 269, 770, 7, 101, 209, 1437, 53, 51, 95, 399, 75, 356, 235, 15, 127, 195, 108, 246, 2345, 102, 35156, 5120, 4, 939, 33, 380, 35841, 8, 460, 619, 66, 9, 317, 2498, 2084, 6149, 1033, 1437, 98, 2085, 939, 437, 95, 45, 5, 235, 1002, 13, 209, 1437, 53, 51, 1415, 98, 11962, 8, 939, 770, 7, 492, 106, 10, 860, 4, 5, 13977, 21, 350, 239, 13, 127, 25896, 1437, 8, 5, 2985, 18459, 58, 350, 380, 8, 851, 162, 10, 33062, 3786, 356, 4, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]	I really wanted to like these  but they just didn't look right on my 5'3 sorta bulky frame. i have big thighs and always feel out of place wearing leggings  so maybe i'm just not the right target for these  but they looked so cute and i wanted to give them a try. the waist was too high for my liking  and the leg openings were too big and gave me a stumpified look.	2023-02-07T20:04:40Z
17752	1	2	[0, 713, 16, 10, 1528, 5262, 299, 42514, 571, 26875, 1827, 8, 1237, 650, 4, 939, 2333, 3568, 10, 650, 50, 4761, 11, 6215, 13657, 1437, 53, 15679, 219, 939, 460, 1836, 62, 4, 939, 437, 10, 2491, 438, 1437, 8, 10, 739, 10698, 1969, 4, 5, 760, 16, 10, 828, 11708, 1437, 53, 45, 98, 203, 47, 240, 10, 740, 5602, 4, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]	This is a true tiny top........gorgeous and runs small. i usually wear a small or medium in retailer tops  but timy i always size up. i'm a 36c  and a large fits perfect. the front is a bit sheer  but not so much you need a cami.	2023-02-07T20:04:40Z
65	1	2	[0, 100, 3584, 42, 299, 11, 41, 9876, 1001, 1400, 94, 186, 4, 5, 1318, 16, 4613, 8, 5, 2272, 1173, 2440, 3195, 16, 182, 2216, 4, 5, 3089, 11556, 34, 10, 2721, 4140, 219, 740, 7042, 1020, 459, 14, 16, 7391, 23, 5, 10762, 1437, 53, 64, 28, 2928, 30, 11803, 4, 939, 362, 29, 372, 77, 10610, 80, 430, 1319, 4, 939, 5328, 24, 19, 5, 2205, 4104, 66, 1437, 8, 24, 3723, 15390, 149, 5, 3089, 11556, 23, 5, 2576, 4, 24, 67, 1326, 372, 77, 5, 11021, 354, 4104, 16, 10610, 11, 4, 127, 129, 2813, 16, 14, 24, 74, 283, 11, 10, 4716, 1459, 1836, 25, 24, 18, 10, 2842, 380, 23, 5, 10762, 8, 5397, 3572, 2, 1, 1, 1, 1, 1]	I purchased this top in an antro store last week. the quality is wonderful and the greenish blue color is very unique. the blouse has a beautiful stretchy camsiole that is attached at the shoulders  but can be removed by snaps. i tooks great when worn two different ways. i wore it with the campole out  and it peeks through the blouse at the bottom. it also looks great when the camisole is worn in. my only wish is that it would come in a petite size as it's a touch big at the shoulders and neckli	2023-02-07T20:04:40Z
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>head -n <span class="m">5</span> ./balanced/sentiment-validation/part-algo-1-womens_clothing_ecommerce_reviews.tsv
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>review_id	sentiment	label_id	input_ids	review_body	date
5506	1	2	[0, 19065, 3588, 11, 1110, 9, 1468, 1437, 1318, 1437, 5780, 734, 18891, 59, 5, 2408, 19, 5, 14187, 156, 24, 45, 173, 13, 162, 4, 939, 2740, 65, 1836, 159, 25, 5131, 30, 97, 34910, 1437, 53, 14, 399, 75, 173, 131, 89, 21, 350, 203, 10199, 13, 5, 5933, 8, 5, 14187, 156, 24, 356, 19351, 4, 939, 2740, 10, 4761, 8, 939, 113, 119, 195, 108, 245, 113, 15, 5, 5350, 11454, 526, 4, 14223, 157, 4, 939, 348, 56, 98, 203, 6620, 19, 97, 6215, 3365, 98, 939, 437, 45, 350, 5779, 4, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]	"Great dress in terms of material  quality  print...something about the weight with the lining made it not work for me. i ordered one size down as recommended by other reviewers  but that didn't work; there was too much fabric for the length and the lining made it look heavier. i ordered a medium and i""m 5'5"" on the curvy side. oh well. i've had so much luck with other retailer orders so i'm not too disappointed."	2023-02-07T20:04:40Z
8480	0	1	[0, 713, 2170, 473, 45, 109, 42, 16576, 2427, 4, 24, 16, 12058, 4, 959, 1437, 5, 13977, 21, 98, 650, 14, 5, 16721, 1344, 11532, 88, 127, 13977, 442, 162, 206, 9, 10, 25818, 11809, 2187, 4, 9574, 1437, 24, 21, 5, 1154, 1836, 98, 939, 64, 75, 1836, 62, 4, 939, 437, 204, 108, 1225, 113, 98, 5, 5933, 21, 1969, 111, 24, 376, 7, 235, 1065, 127, 15145, 4, 939, 657, 5, 16576, 98, 203, 14, 939, 437, 2811, 11356, 366, 27345, 4, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]	"This picture does not do this skirt justice. it is gorgeous. however  the waist was so small that the sequins dug into my waist making me think of a medieval torture device. unfortunately  it was the largest size so i can't size up. i'm 4'11"" so the length was perfect - it came to right above my knees. i love the skirt so much that i'm considering liposuction."	2023-02-07T20:04:40Z
66	0	1	[0, 100, 829, 42, 6399, 11, 127, 6097, 3023, 29, 8, 24, 10698, 6683, 4, 939, 116, 119, 45, 5373, 11, 657, 19, 24, 53, 939, 67, 218, 116, 90, 28101, 4, 5, 6399, 16, 15, 5, 7174, 526, 4, 109, 939, 240, 7, 3568, 10, 740, 5602, 12213, 24, 1437, 117, 4, 127, 2212, 16, 6538, 4, 24, 473, 8736, 162, 9, 10, 1468, 14, 115, 2179, 103, 6538, 71, 103, 3568, 8, 21, 5065, 4, 19, 14, 145, 26, 939, 116, 890, 10397, 42, 6399, 11, 2569, 514, 8, 6713, 3841, 8, 5952, 14, 40, 2097, 6538, 31, 2623, 4, 5, 5933, 16, 2051, 8, 939, 109, 101, 5, 3369, 2629, 11, 760, 116, 405, 3639, 10, 410, 14548, 2, 1, 1, 1, 1, 1, 1]	I received this shirt in my typical xs and it fits perfectly. i?m not crazy in love with it but i also don?t dislike. the shirt is on the thin side. do i need to wear a cami underneath it  no. my concern is holes. it does remind me of a material that could develop some holes after some wear and washes. with that being said i?ll wash this shirt in cold water and hang dry and hopefully that will prevent holes from developing. the length is fine and i do like the slits in front?it adds a little dim	2023-02-07T20:04:40Z
10411	-1	0	[0, 100, 33, 57, 546, 23, 42, 23204, 804, 187, 24, 78, 376, 66, 8, 939, 1747, 2740, 24, 77, 24, 21, 843, 207, 160, 4, 939, 2740, 10, 1836, 475, 4716, 1459, 1437, 16748, 77, 24, 2035, 8, 939, 1381, 24, 15, 1437, 24, 21, 182, 2233, 219, 1437, 13116, 101, 1437, 8, 222, 45, 3041, 101, 24, 1415, 15, 5, 1421, 804, 98, 939, 1051, 24, 124, 4, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]	I have been looking at this sweater online since it first came out and i finally ordered it when it was 40% off. i ordered a size m petite  sadly when it arrived and i tried it on  it was very boxy  stiff like  and did not flow like it looked on the model online so i sent it back.	2023-02-07T20:04:40Z
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>head -n <span class="m">5</span> ./balanced/sentiment-test/part-algo-1-womens_clothing_ecommerce_reviews.tsv
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>review_id	sentiment	label_id	input_ids	review_body	date
4815	0	1	[0, 100, 300, 5, 1275, 1437, 61, 21, 765, 30145, 5202, 4, 5, 6399, 1495, 21, 98, 11962, 1437, 53, 5, 2564, 16, 182, 2233, 219, 4, 939, 300, 10, 650, 8, 24, 21, 169, 350, 1810, 4, 444, 6012, 8, 10941, 11, 5, 13977, 87, 5, 2170, 924, 4, 939, 524, 5074, 7, 671, 1437, 53, 24, 817, 162, 356, 101, 10, 3925, 4, 36, 43882, 14, 16, 43, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]	I got the red  which was short sleeved. the shirt itself was so cute  but the fit is very boxy. i got a small and it was way too wide. far wider and shorter in the waist than the picture shows. i am sad to return  but it makes me look like a square. (shape that is)	2023-02-07T20:04:40Z
1933	1	2	[0, 1708, 5, 124, 9, 24, 1437, 30, 5, 13977, 1437, 15713, 5559, 95, 10, 5262, 828, 4, 114, 939, 120, 2671, 1437, 24, 40, 28, 350, 251, 4, 53, 939, 657, 5, 16576, 1437, 24, 16, 34203, 8, 11962, 4, 45, 24, 17414, 13, 162, 190, 114, 5, 1270, 161, 24787, 4, 939, 2740, 5, 16273, 642, 8, 5, 5933, 16, 1256, 203, 25, 7092, 1437, 95, 874, 5, 4117, 11, 760, 4, 5, 13977, 16, 41783, 1437, 2671, 24, 74, 1136, 55, 15, 127, 28097, 36, 2457, 1755, 5, 350, 251, 1129, 656, 4, 36, 15314, 23246, 1437, 973, 12, 2518, 11, 13977, 1437, 765, 5856, 41137, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]	But the back of it  by the waist  bunches just a tiny bit. if i get bigger  it will be too long. but i love the skirt  it is flattering and cute. not itchy for me even if the title says wool. i ordered the 00p and the length is pretty much as pictured  just below the knee in front. the waist is snug  bigger it would fall more on my hips (hence the too long comment earlier. (115 lbs  26-27 in waist  short legs...)	2023-02-07T20:04:40Z
14029	-1	0	[0, 100, 269, 657, 5, 6184, 8, 5, 356, 15, 5, 1421, 1437, 8, 939, 802, 939, 74, 657, 24, 4, 939, 2740, 804, 1437, 98, 939, 222, 45, 860, 15, 11, 1400, 4, 77, 939, 1381, 24, 15, 1437, 24, 34, 169, 350, 203, 10199, 198, 5, 13977, 8, 16576, 4, 24, 16, 7992, 10199, 25, 157, 1437, 8, 34, 10, 14187, 1437, 8, 5, 13977, 34, 1823, 10199, 13, 5, 1521, 1437, 8, 24, 34, 12189, 1437, 98, 24, 70, 3639, 62, 7, 28, 169, 350, 35156, 4, 24, 16, 45, 34203, 23, 70, 8, 156, 162, 356, 158, 2697, 19351, 4, 939, 524, 3357, 42, 3588, 4, 5074, 1437, 142, 24, 1326, 98, 9869, 15, 5, 1421, 4, 939, 524, 2, 1, 1, 1, 1]	I really love the pattern and the look on the model  and i thought i would love it. i ordered online  so i did not try on in store. when i tried it on  it has way too much fabric around the waist and skirt. it is thick fabric as well  and has a lining  and the waist has extra fabric for the design  and it has pockets  so it all adds up to be way too bulky. it is not flattering at all and made me look 10 pounds heavier. i am returning this dress. sad  because it looks so lovely on the model. i am	2023-02-07T20:04:40Z
10468	0	1	[0, 713, 6966, 18605, 16, 182, 157, 156, 8, 190, 39083, 906, 11, 621, 4, 939, 437, 195, 108, 398, 113, 8, 59, 17445, 2697, 4, 939, 2333, 3568, 10, 1836, 231, 4, 939, 3568, 10, 2631, 417, 11689, 4, 939, 303, 5, 3235, 7, 422, 10, 828, 650, 4, 939, 1835, 24, 142, 1437, 1135, 141, 203, 939, 6640, 5, 2496, 1437, 24, 95, 938, 75, 34203, 15, 127, 809, 1907, 4, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]	"This swimsuit is very well made and even prettier in person. i'm 5'8"" and about 145 pounds. i usually wear a size 6. i wear a 34d bra. i found the suit to run a bit small. i returned it because  despite how much i liked the style  it just wasn't flattering on my body type."	2023-02-07T20:04:40Z
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Query-the-Feature-Store">
<a class="anchor" href="#Query-the-Feature-Store" aria-hidden="true"><span class="octicon octicon-link"></span></a>Query the Feature Store<a class="anchor-link" href="#Query-the-Feature-Store"> </a>
</h2>
<p>In addition to transforming the data and saving in S3 bucket, the processing job populates the feature store with the transformed and balanced data.  Let's query this data using Amazon Athena.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Export-training,-validation,-and-test-datasets-from-the-Feature-Store">
<a class="anchor" href="#Export-training,-validation,-and-test-datasets-from-the-Feature-Store" aria-hidden="true"><span class="octicon octicon-link"></span></a>Export training, validation, and test datasets from the Feature Store<a class="anchor-link" href="#Export-training,-validation,-and-test-datasets-from-the-Feature-Store"> </a>
</h3>
<p>Here we will do the export only for the training dataset, as an example.</p>
<p>We will use the <code>athena_query()</code> function to create an Athena query for the defined above Feature Group. Then we can pull the table name of the Amazon Glue Data Catalog table which is auto-generated by Feature Store.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">feature_store_query</span> <span class="o">=</span> <span class="n">feature_group</span><span class="o">.</span><span class="n">athena_query</span><span class="p">()</span>

<span class="n">feature_store_table</span> <span class="o">=</span> <span class="n">feature_store_query</span><span class="o">.</span><span class="n">table_name</span>

<span class="n">query_string</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    SELECT date,</span>
<span class="s2">        review_id,</span>
<span class="s2">        sentiment, </span>
<span class="s2">        label_id,</span>
<span class="s2">        input_ids,</span>
<span class="s2">        review_body</span>
<span class="s2">    FROM "</span><span class="si">{}</span><span class="s2">" </span>
<span class="s2">    WHERE split_type='train' </span>
<span class="s2">    LIMIT 5</span>
<span class="s2">"""</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">feature_store_table</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">'Glue Catalog table name: </span><span class="si">{}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">feature_store_table</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'Running query: </span><span class="si">{}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">query_string</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Glue Catalog table name: reviews-feature-group-1675799708-1675800251
Running query: 
    SELECT date,
        review_id,
        sentiment, 
        label_id,
        input_ids,
        review_body
    FROM "reviews-feature-group-1675799708-1675800251" 
    WHERE split_type='train' 
    LIMIT 5

</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now we configure the S3 location for the query results.  This allows us to re-use the query results for future queries if the data has not changed.  We can even share this S3 location between team members to improve query performance for common queries on data that does not change often.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">output_s3_uri</span> <span class="o">=</span> <span class="s1">'s3://</span><span class="si">{}</span><span class="s1">/query_results/</span><span class="si">{}</span><span class="s1">/'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">bucket</span><span class="p">,</span> <span class="n">feature_store_offline_prefix</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">output_s3_uri</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>s3://sagemaker-us-east-1-951182689916/query_results/reviews-feature-store-1675799708/
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's query the feature store.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">feature_store_query</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
    <span class="n">query_string</span><span class="o">=</span><span class="n">query_string</span><span class="p">,</span>
    <span class="n">output_location</span><span class="o">=</span><span class="n">output_s3_uri</span> 
<span class="p">)</span>

<span class="n">feature_store_query</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s2">"max_colwidth"</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="n">df_feature_store</span> <span class="o">=</span> <span class="n">feature_store_query</span><span class="o">.</span><span class="n">as_dataframe</span><span class="p">()</span>
<span class="n">df_feature_store</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>review_id</th>
      <th>sentiment</th>
      <th>label_id</th>
      <th>input_ids</th>
      <th>review_body</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2023-02-07T20:04:40Z</td>
      <td>3151</td>
      <td>0</td>
      <td>1</td>
      <td>[0, 17425, 27941, 181, 267, 1318, 4, 939, 33, 10, 5342, 7174, 5120, 8, 42, 10601, 15, 162, 101, ...</td>
      <td>Definitely pj quality. i have a fairly thin frame and this hung on me like a tent. and it's very...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2023-02-07T20:04:40Z</td>
      <td>2313</td>
      <td>0</td>
      <td>1</td>
      <td>[0, 713, 16, 10, 182, 11962, 3588, 4, 24, 21, 1969, 137, 939, 15158, 24, 4, 5, 1272, 939, 56, 71...</td>
      <td>This is a very cute dress. it was perfect before i washed it. the problems i had after washing i...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2023-02-07T20:04:40Z</td>
      <td>10378</td>
      <td>1</td>
      <td>2</td>
      <td>[0, 100, 2162, 5, 10521, 1437, 61, 16, 10, 12058, 3195, 4, 939, 101, 5, 251, 5933, 11, 5, 3701, ...</td>
      <td>I bought the grey  which is a gorgeous color. i like the long length in the arms (though i tried...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2023-02-07T20:04:40Z</td>
      <td>13251</td>
      <td>0</td>
      <td>1</td>
      <td>[0, 37396, 299, 804, 111, 8578, 11, 621, 4, 1237, 650, 1437, 941, 15, 2576, 23385, 1902, 4, 802,...</td>
      <td>Pretty top online - okay in person. runs small  especially on bottom hemline. thought it would h...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2023-02-07T20:04:40Z</td>
      <td>9286</td>
      <td>-1</td>
      <td>0</td>
      <td>[0, 713, 299, 16, 2721, 804, 8, 11, 621, 4, 939, 524, 11, 117, 169, 10, 739, 455, 11464, 22101, ...</td>
      <td>This top is beautiful online and in person. i am in no way a large full figured gal  but i did o...</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Export-TSV-from-Feature-Store">
<a class="anchor" href="#Export-TSV-from-Feature-Store" aria-hidden="true"><span class="octicon octicon-link"></span></a>Export TSV from Feature Store<a class="anchor-link" href="#Export-TSV-from-Feature-Store"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Save the output as a TSV file:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_feature_store</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">'./feature_store_export.tsv'</span><span class="p">,</span>
                        <span class="n">sep</span><span class="o">=</span><span class="s1">'</span><span class="se">\t</span><span class="s1">'</span><span class="p">,</span>
                        <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                        <span class="n">header</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>head -n <span class="m">5</span> ./feature_store_export.tsv
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>date	review_id	sentiment	label_id	input_ids	review_body
2023-02-07T20:04:40Z	3151	0	1	[0, 17425, 27941, 181, 267, 1318, 4, 939, 33, 10, 5342, 7174, 5120, 8, 42, 10601, 15, 162, 101, 10, 10178, 4, 8, 24, 18, 182, 7174, 1437, 98, 24, 1364, 25, 10, 6966, 1719, 1437, 53, 2299, 45, 10, 3588, 13, 932, 1493, 4, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]	Definitely pj quality. i have a fairly thin frame and this hung on me like a tent. and it's very thin  so it works as a swim cover  but definitely not a dress for anything else.
2023-02-07T20:04:40Z	2313	0	1	[0, 713, 16, 10, 182, 11962, 3588, 4, 24, 21, 1969, 137, 939, 15158, 24, 4, 5, 1272, 939, 56, 71, 14784, 24, 21, 5, 15705, 13178, 10490, 9, 5, 3588, 28704, 5933, 11036, 150, 5, 1025, 909, 14187, 222, 45, 1437, 98, 5, 909, 14187, 3723, 15390, 66, 10, 205, 10468, 50, 80, 4, 8, 187, 5, 3588, 16, 10941, 939, 64, 75, 269, 3568, 24, 396, 634, 741, 17625, 13344, 1437, 941, 13, 5, 124, 9, 5, 3588, 187, 24, 18, 10941, 89, 8, 114, 939, 18822, 81, 47, 115, 192, 960, 4, 939, 437, 98, 5779, 11, 5, 1318, 142, 24, 16, 10, 182, 11962, 1437, 4342, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]	This is a very cute dress. it was perfect before i washed it. the problems i had after washing it was the outer cotton layer of the dress shrunk length wise while the inside black lining did not  so the black lining peeks out a good inch or two. and since the dress is shorter i can't really wear it without using biker shorts  especially for the back of the dress since it's shorter there and if i bent over you could see everything. i'm so disappointed in the quality because it is a very cute  ver
2023-02-07T20:04:40Z	10378	1	2	[0, 100, 2162, 5, 10521, 1437, 61, 16, 10, 12058, 3195, 4, 939, 101, 5, 251, 5933, 11, 5, 3701, 36, 18401, 939, 1381, 24, 15, 11, 430, 8089, 8, 5, 3124, 5933, 222, 182, 322, 3793, 8, 1256, 4, 939, 101, 5, 5933, 4, 5, 124, 473, 14902, 15673, 1437, 53, 939, 202, 101, 5, 6399, 4, 24, 18, 7082, 1437, 9881, 8, 34203, 4, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]	I bought the grey  which is a gorgeous color. i like the long length in the arms (though i tried it on in different colors and the arm length did very). soft and pretty. i like the length. the back does wrinkle  but i still like the shirt. it's loose  casual and flattering.
2023-02-07T20:04:40Z	13251	0	1	[0, 37396, 299, 804, 111, 8578, 11, 621, 4, 1237, 650, 1437, 941, 15, 2576, 23385, 1902, 4, 802, 24, 74, 33, 10, 7021, 7, 24, 4, 24, 473, 45, 4, 55, 11708, 11, 621, 87, 939, 802, 24, 74, 28, 4, 14, 1979, 75, 912, 162, 31, 2396, 24, 600, 4, 24, 21, 5, 169, 24, 4976, 15, 127, 7050, 14, 21, 29747, 24203, 4, 1415, 101, 939, 21, 2498, 10, 741, 1452, 4, 939, 218, 75, 33, 10, 739, 7050, 1437, 95, 7735, 356, 15, 162, 4, 9327, 1437, 142, 24, 16, 41, 15652, 5780, 4, 299, 156, 13, 29284, 50, 10, 4716, 1459, 6429, 4, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]	Pretty top online - okay in person. runs small  especially on bottom hemline. thought it would have a swing to it. it does not. more sheer in person than i thought it would be. that wouldn't stop me from keeping it though. it was the way it laid on my chest that was unflattering. looked like i was wearing a bib. i don't have a large chest  just weird look on me. unfortunate  because it is an adorable print. top made for thinner or a petite lady.
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Upload TSV to the S3 bucket:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>aws s3 cp ./feature_store_export.tsv s3://<span class="nv">$bucket</span>/feature_store/feature_store_export.tsv
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>upload: ./feature_store_export.tsv to s3://sagemaker-us-east-1-951182689916/feature_store/feature_store_export.tsv
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Check the file in the S3 bucket:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>aws s3 ls --recursive s3://<span class="nv">$bucket</span>/feature_store/feature_store_export.tsv
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>2023-02-07 20:11:18       4714 feature_store/feature_store_export.tsv
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Check-that-the-dataset-in-the-Feature-Store-is-balanced-by-sentiment">
<a class="anchor" href="#Check-that-the-dataset-in-the-Feature-Store-is-balanced-by-sentiment" aria-hidden="true"><span class="octicon octicon-link"></span></a>Check that the dataset in the Feature Store is balanced by sentiment<a class="anchor-link" href="#Check-that-the-dataset-in-the-Feature-Store-is-balanced-by-sentiment"> </a>
</h3>
<p>Now we can setup an Athena query to check that the stored dataset is balanced by the target class <code>sentiment</code>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We will rrite an SQL query to count the total number of the reviews per <code>sentiment</code> stored in the Feature Group.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">feature_store_query_2</span> <span class="o">=</span> <span class="n">feature_group</span><span class="o">.</span><span class="n">athena_query</span><span class="p">()</span>

<span class="n">query_string_count_by_sentiment</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">SELECT sentiment, COUNT(*) AS count_reviews</span>
<span class="s2">FROM "</span><span class="si">{}</span><span class="s2">"</span>
<span class="s2">GROUP BY sentiment</span>
<span class="s2">"""</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">feature_store_table</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now we query the feature store.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">feature_store_query_2</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
    <span class="n">query_string</span><span class="o">=</span><span class="n">query_string_count_by_sentiment</span><span class="p">,</span> 
    <span class="n">output_location</span><span class="o">=</span><span class="n">output_s3_uri</span> 
<span class="p">)</span>

<span class="n">feature_store_query_2</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>

<span class="n">df_count_by_sentiment</span> <span class="o">=</span> <span class="n">feature_store_query_2</span><span class="o">.</span><span class="n">as_dataframe</span><span class="p">()</span>
<span class="n">df_count_by_sentiment</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sentiment</th>
      <th>count_reviews</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>2051</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-1</td>
      <td>2051</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>2051</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's visualize the result of the query in the bar plot, showing the count of the reviews by sentiment value.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>

<span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">df_count_by_sentiment</span><span class="p">,</span> 
    <span class="n">x</span><span class="o">=</span><span class="s1">'sentiment'</span><span class="p">,</span> 
    <span class="n">y</span><span class="o">=</span><span class="s1">'count_reviews'</span><span class="p">,</span> 
    <span class="n">color</span><span class="o">=</span><span class="s2">"blue"</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7f9c4f4c9710&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAkQAAAGwCAYAAABIC3rIAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAPYQAAD2EBqD+naQAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4xLjMsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy+AADFEAAAgAElEQVR4nO3de3RU5b3/8c8IZAiQjIm5TAIBYosIJgYJCoHKxWog3Ip4x6agGOtBTTHwA6NWQYVUEeQcqRTxgpd45LQgVdCYQCWIhKtE5NIUMRQ8JAQhTCDKJCT794eLfRgDisMkM2G/X2vttWY/+9nPfDdrs/JZzzx7xmYYhiEAAAALu8jfBQAAAPgbgQgAAFgegQgAAFgegQgAAFgegQgAAFgegQgAAFgegQgAAFheS38X0FzU19frwIEDCgkJkc1m83c5AADgHBiGoWPHjik2NlYXXXT2eSAC0Tk6cOCA4uLi/F0GAADwwv79+9WhQ4ezHicQnaOQkBBJ3/+DhoaG+rkaAABwLqqqqhQXF2f+HT8bAtE5OvUxWWhoKIEIAIBm5qeWu7CoGgAAWB6BCAAAWB6BCAAAWB6BCAAAWB6BCAAAWB6BCAAAWB6BCAAAWB6BCAAAWB6BCAAAWB6BCAAAWB6BCAAAWB6BCAAAWB6BCAAAWB6BCAAAWB6BCAAAWF5LfxdgJfHxe/1dAgJIaWlnf5cgifsSngLhvuSexOma6p5khggAAFgegQgAAFgegQgAAFgegQgAAFieXwNRTk6Orr76aoWEhCgqKkqjRo1SSUmJRx+3260HH3xQERERatu2rUaOHKmvv/7ao8++ffs0YsQItW3bVhEREcrMzFRNTY1Hn8LCQiUnJ6t169a69NJL9Ze//KXRrw8AADQPfg1EhYWFuv/++7V+/XoVFBTo5MmTSk1NVXV1tdln4sSJevfdd/XOO+9o7dq1On78uIYPH666ujpJUl1dnYYNG6bq6mqtXbtW77zzjpYsWaJJkyaZY5SWlmro0KG69tprtXXrVj3yyCPKzMzUkiVLmvyaAQBA4LEZhmH4u4hTDh06pKioKBUWFqp///5yuVyKjIzUm2++qdtuu02SdODAAcXFxemDDz7Q4MGD9eGHH2r48OHav3+/YmNjJUnvvPOOxo0bp4qKCoWGhmrq1Kl67733tGvXLvO97rvvPn3++ecqKio6Yy1ut1tut9vcr6qqUlxcnFwul0JDQ726Ph4lxekC4fFmifsSngLhvuSexOnO956sqqqSw+H4yb/fAbWGyOVySZLCw8MlSVu2bFFtba1SU1PNPrGxsUpISNC6deskSUVFRUpISDDDkCQNHjxYbrdbW7ZsMfucPsapPps3b1Ztbe0Za8nJyZHD4TC3uLg4310oAAAIKAETiAzDUFZWln71q18pISFBklReXq6goCCFhYV59I2OjlZ5ebnZJzo62uN4WFiYgoKCfrRPdHS0Tp48qW+++eaM9WRnZ8vlcpnb/v37fXKdAAAg8ATMN1U/8MAD2rZtm9auXfuTfQ3DkM1mM/dPf32ufU59UnimcyXJbrfLbrefU+0AAKB5C4gZogcffFDvvfeePv74Y3Xo0MFsdzqdqqmpUWVlpUf/iooKc8bH6XSaM0GnVFZWqra29kf7VFRUqGXLlrrkkksa45IAAEAz4tdAZBiGHnjgAS1dulT/+Mc/FB8f73E8OTlZrVq1UkFBgdlWVlam7du3q2/fvpKklJQUbd++XWVlZWaf/Px82e12JScnm31OH+NUn169eqlVq1aNdXkAAKCZ8Gsguv/++/XWW2/p7bffVkhIiMrLy1VeXq7vvvtOkuRwODR+/HhNmjRJq1at0tatW/Xb3/5WiYmJuv766yVJqamp6t69u9LT07V161atWrVKkydPVkZGhrma/L777tO///1vZWVladeuXXr11Vf1yiuvaPLkyX67dgAAEDj8Gojmz58vl8ulgQMHKiYmxtwWL15s9nn++ec1atQo3XrrrerXr5/atGmj999/Xy1atJAktWjRQitWrFDr1q3Vr18/3XrrrRo1apSee+45c4z4+Hh98MEHWr16tXr06KGnnnpK//Vf/6Wbbrqpya8ZAAAEnoD6HqJAdq7fY/Bj+G4NnC4Qvu9F4r6Ep0C4L7kncTpLfg8RAACAPxCIAACA5RGIAACA5RGIAACA5RGIAACA5RGIAACA5RGIAACA5RGIAACA5RGIAACA5RGIAACA5RGIAACA5RGIAACA5RGIAACA5RGIAACA5RGIAACA5RGIAACA5RGIAACA5RGIAACA5RGIAACA5RGIAACA5RGIAACA5RGIAACA5RGIAACA5RGIAACA5RGIAACA5RGIAACA5RGIAACA5RGIAACA5RGI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f76++OILvfHGGzp69KhiYmI0aNAgLV68WCEhIeY5zz//vFq2bKlbb71V3333nX79619r0aJFatGihSSpRYsWWrFihSZMmKB+/fopODhYY8aM0XPPPde0FwsAAAKWzTAMw99FNAdVVVVyOBxyuVxezyzFx+/1bVFo1kpLO/u7BEncl/AUCPcl9yROd7735Ln+/W5Wa4gAAAAaA4EIAABYHoEIAABYHoEIAABYHoEIAABYHoEIAABYHoEIAABYHoEIAABYHoEIAABYHoEIAABYHoEIAABYHoEIAABYHoEIAABYHoEIAABYHoEIAABYHoEIAABYHoEIAABYHoEIAABYHoEIAABYnleBKC8vT2vXrjX3//znP6tHjx4aM2aMKisrfVYcAABAU/AqEP2///f/VFVVJUn64osvNGnSJA0dOlRfffWVsrKyfFogAABAY2vpzUmlpaXq3r27JGnJkiUaPny4Zs6cqc8++0xDhw71aYEAAACNzasZoqCgIH377beSpJUrVyo1NVWSFB4ebs4cAQAANBdezRD96le/UlZWlvr166eNGzdq8eLFkqR//etf6tChg08LBAAAaGxezRDNmzdPLVu21N/+9jfNnz9f7du3lyR9+OGHGjJkiE8LBAAAaGxezRB17NhRy5cvb9D+/PPPn3dBAAAATc2rGaI777xTCxcu1O7du31dDwAAQJPzKhC1a9dOs2fPVteuXRUbG6s77rhDf/nLX/TPf/7T1/UBAAA0Oq8C0YIFC/TPf/5TBw4c0Jw5c+RwOPSf//mfuuKKKxQTE+PrGgEAABrVef10R0hIiMLCwhQWFqaLL75YLVu2lNPp9FVtAAAATcKrQDR16lT16dNHEREReuyxx1RTU6Ps7GwdPHhQW7du9XWNAAAAjcqrp8xmzZqlyMhIPfHEE/rNb36jbt26+bouAACAJuPVDNHWrVv16KOPauPGjerfv7+cTqduu+02zZ8/X7t27TrncdasWaMRI0YoNjZWNptNy5YtM4/V1tZq6tSpSkxMVNu2bRUbG6vf/e53OnDggMcYnTt3ls1m89gefvhhjz779u3TiBEj1LZtW0VERCgzM1M1NTXeXDoAALgAeTVDlJSUpKSkJGVmZkqSPv/8c82dO1eZmZmqr69XXV3dOY1TXV2tpKQk3XXXXbrppps8jn377bf67LPP9Mc//lFJSUmqrKzUxIkTNXLkSG3evNmj75NPPqmMjAxzv127dubruro6DRs2TJGRkVq7dq0OHz6ssWPHyjAMvfDCC95cPgAAuMB4FYik72eJVq9erdWrV+uTTz5RVVWVevTooUGDBp3zGGlpaUpLSzvjMYfDoYKCAo+2F154Qddcc4327dunjh07mu0hISFnXcydn5+vnTt3av/+/YqNjZUkzZ49W+PGjdOMGTMUGhp6xvPcbrfcbre5z2+0AQBw4fLqI7OwsDBdc801ys3NVZcuXfTGG2/oyJEj2rx5s2bNmuXrGk0ul0s2m00XX3yxR/szzzyjSy65RD169NCMGTM8Pg4rKipSQkKCGYYkafDgwXK73dqyZctZ3ysnJ0cOh8Pc4uLifH9BAAAgIHg1Q/Tmm2+qf//+Z51daQwnTpzQww8/rDFjxni87x/+8Af17NlTYWFh2rhxo7Kzs1VaWqqXX35ZklReXq7o6GiPscLCwhQUFKTy8vKzvl92draysrLM/aqqKkIRAAAXKK8C0fDhwyVJX375pfbs2aP+/fsrODhYhmHIZrP5tEDp+wXWt99+u+rr6/Xiiy96HHvooYfM11deeaXCwsJ08803m7NGks5Y00/VarfbZbfbfXQFAAAgkHn1kdnhw4f161//WpdddpmGDh2qsrIySdI999yjSZMm+bTA2tpa3XrrrSotLVVBQcFPzkr16dNH0vdhTZKcTmeDmaDKykrV1tY2mDkCAADW5FUgeuihh9SqVSvt27dPbdq0Mdtvu+025eXl+ay4U2Fo9+7dWrlypTnj82NOfTHkqZ8QSUlJ0fbt283QJn2/0Nputys5OdlntQIAgObLq4/M8vPz9dFHH6lDhw4e7V26dNG///3vcx7n+PHj5kyOJJWWlqq4uFjh4eGKjY3VzTffrM8++0zLly9XXV2dOdMTHh6uoKAgFRUVaf369Ro0aJAcDoc2bdqkhx56SCNHjjSfQktNTVX37t2Vnp6uWbNm6ciRI5o8ebIyMjKadA0UAAAIXF4Fourqao+ZoVO++eabn7XuZvPmzR6P6Z9axDx27FhNmzZN7733niSpR48eHud9/PHHGjhwoOx2uxYvXqzp06fL7XarU6dOysjI0JQpU8y+LVq00IoVKzRhwgT169dPwcHBGjNmjJ577rmfdc0AAODC5VUg6t+/v9544w099dRTkr5ftFxfX69Zs2b9rO8hGjhwoAzDOOvxHzsmST179tT69et/8n06duyo5cuXn3NdAADAWrz+LbOBAwdq8+bNqqmp0ZQpU7Rjxw4dOXJEn376qa9rBAAAaFReLaru3r27tm3bpmuuuUY33HCDqqurNXr0aG3dulW/+MUvfF0jAABAo/L6pzucTqemT5/uy1oAAAD84pwD0bZt25SQkKCLLrpI27Zt+9G+V1555XkXBgAA0FTOORD16NFD5eXlioqKUo8ePWSz2c646Nlms53zr90DAAAEgnMORKWlpYqMjDRfAwAAXCjOORB16tTJfB0ZGXnG7yECAABojrx6yiwqKkq//e1v9dFHH6m+vt7XNQEAADQprwLRG2+8IbfbrRtvvFGxsbH6wx/+oE2bNvm6NgAAgCbhVSAaPXq0/vrXv+rgwYPKycnRrl271LdvX1122WV68sknfV0jAABAo/IqEJ0SEhKiu+66S/n5+fr888/Vtm1bvpsIAAA0O+cViE6cOKH/+Z//0ahRo9SzZ08dPnxYkydP9lVtAAAATcKrb6rOz89Xbm6uli1bphYtWujmm2/WRx99pAEDBvi6PgAAgEbnVSAaNWqUhg0bptdff13Dhg1Tq1atfF0XAABAk/EqEJWXlys0NNTXtQAAAPiFV2uIQkNDtWfPHj322GO64447VFFRIUnKy8vTjh07fFogAABAY/MqEBUWFioxMVEbNmzQ0qVLdfz4cUnf/wDsE0884dMCAQAAGptXgejhhx/W008/rYKCAgUFBZntgwYNUlFRkc+KAwAAaApeBaIvvvhCN954Y4P2yMhIHT58+LyLAgAAaEpeBaKLL75YZWVlDdq3bt2q9u3bn3dRAAAATcmrQDRmzBhNnTpV5eXlstlsqq+v16effqrJkyfrd7/7na9rBAAAaFReBaIZM2aoY8eOat++vY4fP67u3burf//+6tu3rx577DFf1wgAANCovPoeolatWik3N1dPPfWUPvvsM9XX1+uqq65Sly5dfF0fAABAo/vZgai2tlZdu3bV8uXL1b17d1166aWNURcAAECT+dkfmbVq1Uput1s2m60x6gEAAGhyXq0hevDBB/XMM8/o5MmTvq4HAACgyXm1hmjDhg1atWqV8vPzlZiYqLZt23ocX7p0qU+KAwAAaApeBaKLL75YN910k69rAQAA8AuvAtFrr712Tv0+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FrZmzRqNGDFCsbGxstlsWrZsmb9LsgwCEZpUdXW1+vXrpz/96U/+LgXQ4sWLNXHiRD366KPaunWrrr32WqWlpWnfvn3+Lg0WVV1draSkJM2bN8/fpVgOj93DL/bu3av4+Hht3bpVPXr08Hc5sKjevXurZ8+emj9/vtnWrVs3jRo1Sjk5OX6sDPj+9zffffddjRo1yt+lWAIzRAAsqaamRlu2bFFqaqpHe2pqqtatW+enqgD4C4EIgCV98803qqura/ADz9HR0Q1+CBrAhY9AhEaTm5urdu3amRuLVRGIbDabx75hGA3aAFz4LPNbZmh6I0eOVO/evc399u3b+7EawFNERIRatGjRYDaooqKiwawRgAsfgQiNJiQkRCEhIf4uAzijoKAgJScnq6CgQDfeeKPZXlBQoN/85jd+rAyAPxCI0KSOHDmiffv26cCBA5KkkpISSZLT6ZTT6fRnabCgrKwspaenq1evXkpJSdFLL72kffv26b777vN3abCo48eP68svvzT3S0tLVVxcrPDwcHXs2NGPlV34eOweTWrRokW66667GrQ/8cQTmjZtWtMXBMt78cUX9eyzz6qsrEwJCQl6/vnn1b9/f3+XBYtavXq1Bg0a1KB97NixWrRoUdMXZCEEIgAAYHk8ZQYAACyPQAQAACyPQAQAACyPQAQAACyPQAQAACyPQAQAACyPQAQAACyPQAQAACyPQATAcjp37qy5c+f6uwwAAYRABOCCtWjRIl188cUN2jdt2qR7773XDxV5Wr16tWw2m44ePervUgDL48ddAVhOZGSkv0sAEGCYIQLgV3/729+UmJio4OBgXXLJJbr++utVXV0tSXrttdfUrVs3tW7dWpdffrlefPFF87y9e/fKZrNp6dKlGjRokNq0aaOkpCQVFRVJ+n725a677pLL5ZLNZpPNZjN/QPiHH5nZbDYtWLBAw4cPV5s2bdStWzcVFRXpyy+/1MCBA9W2bVulpKRoz549HrW///77Sk5OVuvWrXXppZdq+vTpOnnypMe4L7/8sm688Ua1adNGXbp00XvvvWfWf+pHPMPCwmSz2TRu3Dif//sCOEcGAPjJgQMHjJYtWxpz5swxSktLjW3bthl//vOfjWPHjhkvvfSSERMTYyxZssT46quvjCVLlhjh4eHGokWLDMMwjNLSUkOScfnllxvLly83SkpKjJtvvtno1KmTUVtba7jdbmPu3LlGaGioUVZWZpSVlRnHjh0zDMMwOnXqZDz//PNmHZKM9u3bG4sXLzZKSkqMUaNGGZ07dzauu+46Iy8vz9i5c6fRp08fY8iQIeY5eXl5RmhoqLFo0SJjz549Rn5+vtG5c2dj2rRpHuN26NDBePvtt43du3cbmZmZRrt27YzDhw8bJ0+eNJYsWWJIMkpKSoyysjLj6NGjTfQvD+CHCEQA/GbLli2GJGPv3r0NjsXFxRlvv/22R9tTTz1lpKSkGIbxf4Ho5ZdfNo/v2LHDkGTs2rXLMAzDeO211wyHw9Fg7DMFoscee8zcLyoqMiQZr7zyitn23//930br1q3N/WuvvdaYOXOmx7hvvvmmERMTc9Zxjx8/bthsNuPDDz80DMMwPv74Y0OSUVlZeaZ/HgBNiDVEAPwmKSlJv/71r5WYmKjBgwcrNTVVN998s06ePKn9+/dr/PjxysjIMPufPHlSDofDY4wrr7zSfB0TEyNJqqio0OWXX/6zajl9nOjoaElSYmKiR9uJEydUVVWl0NBQbdmyRZs2bdKMGTPMPnV1dTpx4oS+/fZbtWnTpsG4bdu2VUhIiCoqKn5WbQAaH4EIgN+0aNFCBQUFWrdunfLz8/XCCy/o0Ucf1fvvvy9JWrhwoXr37t3gnNO1atXKfG2z2SRJ9fX1P7uWM43zY2PX19dr+vTpGj16dIOxWrdufcZxT43jTX0AGheBCIBf2Ww29evXT/369dPjjz+uTp066dNPP1X79u311Vdf6c477/R67KCgINXV1fmw2v/Ts2dPlZSU6Je//KXXYwQFBUlSo9UI4NwRiAD4zYYNG7Rq1SqlpqYqKipKGzZs0KFDh9StWzdNmzZNmZmZCg0NVVpamtxutzZv3qzKykplZWWd0/idO3fW8ePHtWrVKiUlJalNmzbmR1nn6/HHH9fw4cMVFxenW265RRdddJG2bdumL774Qk8//fQ5jdGpUyfZbDYtX75cQ4cOVXBwsNq1a+eT+gD8PDx2D8BvQkNDtWbNGg0dOlSXXXaZHnvsMc2ePVtpaWm655579PLLL2vRokVKTEzUgAEDtGjRIsXHx5/z+H379tV9992n2267TZGRkXr22Wd9VvvgwYO1fPlyFRQU6Oqrr1afPn00Z84cderU6ZzHaN++vaZPn66HH35Y0dHReuCBB3xWH4Cfx2YYhuHvIgAAAPyJGSIAAGB5BCIAAGB5BCIAAGB5BCIAAGB5BCIAAGB5BCIAAGB5BCIAAGB5BCIAAGB5BCIAAGB5BCIAAGB5BCIAAGB5/x9th+j3uGOA4QAAAABJRU5ErkJggg==%0A">
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Acknowledgements">
<a class="anchor" href="#Acknowledgements" aria-hidden="true"><span class="octicon octicon-link"></span></a>Acknowledgements<a class="anchor-link" href="#Acknowledgements"> </a>
</h2>
<p>I'd like to express my thanks to the great <a href="https://www.deeplearning.ai/courses/practical-data-science-specialization/">Deep Learning AI Practical Data Science on AWS Specialisation Course</a> which i completed, and acknowledge the use of some images and other materials from the training course in this article.</p>

</div>
</div>
</div>
</div>



  </div>
  
  <a class="u-url" href="/aws/cloud-data-science/natural-language-processing/deep-learning/2023/02/08/feature-transformation-aws-sagemaker-processing-job-feature-store.html" hidden></a>
</article><!-- from https://github.com/utterance/utterances -->
<script src="https://utteranc.es/client.js"
        repo="pranath/blog"
        issue-term="title"
        label="blogpost-comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">
    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p></p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"></ul>
</div>

  </div>

</footer>
<script type="text/javascript" src="/js/lightbox.js"></script>
<link rel="stylesheet" href="/css/lightbox.css">
</body>

</html>
